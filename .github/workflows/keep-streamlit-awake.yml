name: Keep Streamlit App Awake

on:
  schedule:
    - cron: "*/30 * * * *"  # every 30 min (UTC; GitHub min ~5 min interval) [web:22]
  workflow_dispatch:

jobs:
  ping:
    runs-on: ubuntu-latest
    steps:
      - name: Ping Big Mac Index app
        run: |
          URL="https://bigmacindexlfc.streamlit.app/"
          echo "Pinging $URL"
          curl -L --max-redirs 20 --silent --max-time 45 \
            -H "User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/120.0.0.0 Safari/537.36" \
            -H "Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8" \
            -H "Accept-Language: en-US,en;q=0.5" \
            -H "Connection: keep-alive" \
            "$URL" -o >(head -c 1000) || true
          echo "Traffic sent (exit ignored)"
